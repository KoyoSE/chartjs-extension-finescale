/* !
 * chartjs-extension-finescale.js
 *
 * Version: 0.0.1
 *
 * chartjs-extension-finescale.js Copyright 2016 koyoSE
 * Released under the MIT license
 * https://github.com/KoyoSE/chartjs-extension-finescale.git
 *
 * Chart.js Copyright 2016 Nick Downie
 * Released under the MIT license
 * https://github.com/chartjs/Chart.js/blob/master/LICENSE.md
 */
!function t(i,e,a){function l(s,r){if(!e[s]){if(!i[s]){var n="function"==typeof require&&require;if(!r&&n)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=e[s]={exports:{}};i[s][0].call(f.exports,function(t){var e=i[s][1][t];return l(e?e:t)},f,f.exports,t,i,e,a)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)l(a[s]);return l}({1:[function(t,i,e){t(2)(Chart)},{2:2}],2:[function(t,i,e){i.exports=function(t){"use strict";var i=t.helpers,e={position:"left",subScale:{display:!0,ticks:{display:!0,fontSize:11},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.07)"},subScale:{display:!0,ticks:{display:!1,fontSize:10},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.03)"}}}},a=t.scaleService.getScaleConstructor("linear").extend({niceNum:function(t,e){var a,l=Math.floor(i.log10(t)),o=t/Math.pow(10,l);return a=e?o<=1?5:o<=5?10:20:o<=1?1:o<=2?2:o<=5?5:10,a*Math.pow(10,l)},fineLinear:function(t,e){var a=this,l=[],o=[],s=[],r=[],n=t.optsTick,c=a.niceNum(e.max-e.min,!1),f=[];f[0]=a.niceNum(c/(t.maxTicks-1),!0),f[1]=a.niceNum(f[0]/10,!0),f[2]=a.niceNum(f[1]/10,!0);var d=2;if(t.stepSize&&t.stepSize>0){var u=t.stepSize;u=(e.max-e.min)/u>1e3?Math.floor((e.max-e.min)/1e3):u;for(var g=0;g<t.levelMax;g++)f[g]<=t.stepSize&&(f[g]=u,d=0!==u?g:d,u=0);f[d]=f[d]>t.stepSize?t.stepSize:f[d]}var p,h,k=Math.floor(e.min/f[0])*f[0],m=Math.ceil(e.max/f[0])*f[0],x=void 0!==t.min?t.min:k,v=void 0!==t.max?t.max:m,T=function(t){t=0===t?1:t;var e=Math.floor(i.log10(t));return{digits:e>0?0:Math.abs(e),magnification:Math.pow(10,e)}},y=[T(f[0]),T(f[1]),T(f[2])],b=function(t,i,e){var a=t/e%(i[0]/e),l=t/e%(i[1]/e);return 0===a?0:0===l?1:2},S=+((m-k)/f[d]).toFixed(y[d].digits);l.push(x),o.push(b(x,f,y[d].magnification));for(var D=1;D<S;D++)h=k+ +(D*f[d]).toFixed(y[d].digits),h<=x||v<=h||(p=b(h,f,y[d].magnification),l.push(+h.toFixed(y[p].digits)),o.push(p));l.push(v),o.push(b(v,f,y[d].magnification));var L;for(D=0;D<l.length;D++)L=0===D||(D===l.length-1||!!n[o[D]].display),s.push(L),L&&r.push(l[D]);return{ticks:l,levels:o,min:x,max:v,isDisplayTicks:s,displayTicks:r}},ticksReverse:function(){var t=this;t.ticks.reverse(),t.tickLevels.reverse(),t.isDisplayTicks.reverse(),t.displayTicks.reverse()},handleDirectionalChanges:function(){var t=this;t.isHorizontal()||t.ticksReverse()},getTickLimit:function(){var e,a=this,l=a.options.ticks;if(a.isHorizontal())e=Math.min(l.maxTicksLimit?l.maxTicksLimit:11,Math.ceil(a.width/50));else{var o=i.getValueOrDefault(l.fontSize,t.defaults.global.defaultFontSize);e=Math.min(l.maxTicksLimit?l.maxTicksLimit:11,Math.ceil(a.height/(1.5*o)))}return Math.max(2,e)},buildTicks:function(){var t=this;t.levelMax=3;var e=t.options,a=[e.ticks,e.subScale.ticks,e.subScale.subScale.ticks],l=t.getTickLimit(),o={maxTicks:l,min:a[0].min,max:a[0].max,stepSize:i.getValueOrDefault(a[0].fixedStepSize,a[0].stepSize),optsTick:a,levelMax:t.levelMax},s=t.fineLinear(o,t);t.ticks=s.ticks,t.tickLevels=s.levels,t.isDisplayTicks=s.isDisplayTicks,t.displayTicks=s.displayTicks,t.handleDirectionalChanges(),t.max=s.max,t.min=s.min,a[0].reverse?(t.ticksReverse(),t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max)},computeTextSize:function(t,e,a){return i.isArray(e)?i.longestText(t,a,e):t.measureText(e).width},parseFontOptions:function(e){var a=i.getValueOrDefault,l=t.defaults.global,o=a(e.fontSize,l.defaultFontSize),s=a(e.fontStyle,l.defaultFontStyle),r=a(e.fontFamily,l.defaultFontFamily);return{size:o,style:s,family:r,font:i.fontString(o,s,r)}},draw:function(e){var a=this,l=[a.options,a.options.subScale,a.options.subScale.subScale];if(l[0].display){var o,s=a.ctx,r=t.defaults.global,n=[l[0].ticks,l[1].ticks,l[2].ticks],c=[l[0].gridLines,l[1].gridLines,l[2].gridLines],f=[l[0].scaleLabel,l[1].scaleLabel,l[2].scaleLabel];n[0].maxTicksLimit&&(o=n[0].maxTicksLimit);var d=[a.parseFontOptions(n[0]),a.parseFontOptions(n[1]),a.parseFontOptions(n[2])],u=c[0].drawTicks?[c[0].tickMarkLength,c[1].drawTicks?c[1].tickMarkLength||.6*c[0].tickMarkLength:0,c[2].drawTicks?c[2].tickMarkLength||.4*c[0].tickMarkLength:0]:[0,0,0],g=[],p=i.getValueOrDefault(f[0].fontColor,r.defaultFontColor),h=a.parseFontOptions(f[0]),k=a.isHorizontal(),m=0!==a.labelRotation,x=i.toRadians(a.labelRotation);if(k){var v=!1;if(n[0].autoSkip){var T=Math.cos(x),y=m?a.longestLabelWidth*T/2:a.longestLabelWidth*T,b=(y+n[0].autoSkipPadding)*a.displayTicks.length,S=a.width-(a.paddingLeft+a.paddingRight);if(b>S&&(v=1+Math.floor(b/S)),o&&a.displayTicks.length>o)for(;!v||a.ticks.length/(v||1)>o;)v||(v=1),v+=1}}if(i.each(a.ticks,function(t,o){if(void 0!==t&&null!==t){var s=a.tickLevels[o];if(l[s].display){var f=a.displayTicks.length===o+1,d=v>1&&o%v>0||o%v===0&&o+v>=a.displayTicks.length;if(!d||f){var p,h,T=i.getValueOrDefault(c[s].borderDash,c[0].borderDash),y=i.getValueOrDefault(c[s].borderDashOffset,c[0].borderDashOffset),b=!!c[0].display&&i.getValueOrDefault(c[s].display,c[0].display),S=!!c[0].drawTicks&&i.getValueOrDefault(c[s].drawTicks,c[0].drawTicks),D=!!c[0].drawOnChartArea&&i.getValueOrDefault(c[s].drawOnChartArea,c[0].drawOnChartArea);if(o===("undefined"!=typeof a.zeroLineIndex?a.zeroLineIndex:0))p=c[0].zeroLineWidth,h=c[0].zeroLineColor;else{var L=i.getValueAtIndexOrDefault(c[0].lineWidth,o),O=i.getValueAtIndexOrDefault(c[s].lineWidth,o,c[0].lineWidth);p=i.isArray(c[0].lineWidth)?L:O;var M=i.getValueAtIndexOrDefault(c[0].color,o),z=i.getValueAtIndexOrDefault(c[s].color,o,c[0].color);h=i.isArray(c[0].color)?M:z}var F,w,V,C,P,A,R,W,I,X,Y=i.getValueOrDefault(n[s].fontColor,r.defaultFontColor),B="middle",N="middle";if(k){"bottom"===l[0].position?(N="top",B=m?"right":"center",X=m?a.top+u[0]:a.top+u[s]):(N="bottom",B=m?"left":"center",X=m?a.bottom-u[0]:a.bottom-u[s]),I=a.getPixelForTick(o,c[0].offsetGridLines)+n[0].labelOffset;var H=a.getPixelForTick(o)+i.aliasPixel(p),q="bottom"===l[0].position?a.top:a.bottom-u[s],E="bottom"===l[0].position?a.top+u[s]:a.bottom;F=V=P=R=H,w=q,C=E,A=e.top,W=e.bottom}else{var G,U="left"===l[0].position,_=n[0].padding;n[0].mirror?(B=U?"left":"right",G=_):(B=U?"right":"left",G=u[s]+_),I=U?a.right-G:a.left+G;var j=a.getPixelForTick(o)+i.aliasPixel(p);X=a.getPixelForTick(o,c[0].offsetGridLines);var J="right"===l[0].position?a.left:a.right-u[s],K="right"===l[0].position?a.left+u[s]:a.right;F=J,V=K,P=e.left,R=e.right,w=C=A=W=j}g.push({display:b,level:s,tlDraw:S,tlX1:F,tlY1:w,tlX2:V,tlY2:C,tlColor:c[0].color,glDraw:D,glX1:P,glY1:A,glX2:R,glY2:W,glWidth:p,glColor:h,glBorderDash:T,glBorderDashOffset:y,lDisplay:a.isDisplayTicks[o],lX:I,lY:X,label:t,lRotation:-1*x,lTextBaseline:N,lTextAlign:B,lFontColor:Y})}}}}),i.each(g,function(t){if(t.display&&(s.save(),s.lineWidth=t.glWidth,s.strokeStyle=t.tlColor,s.beginPath(),t.tlDraw&&(s.moveTo(t.tlX1,t.tlY1),s.lineTo(t.tlX2,t.tlY2)),s.stroke(),s.strokeStyle=t.glColor,s.setLineDash&&(s.setLineDash(t.glBorderDash),s.lineDashOffset=t.glBorderDashOffset),t.glDraw&&(s.moveTo(t.glX1,t.glY1),s.lineTo(t.glX2,t.glY2)),s.stroke(),s.restore()),t.lDisplay){s.save(),s.translate(t.lX,t.lY),s.rotate(t.lRotation),s.font=d[t.level].font,s.fillStyle=t.lFontColor,s.textBaseline=t.lTextBaseline,s.textAlign=t.lTextAlign;var e=t.label;if(i.isArray(e))for(var a=0,l=0;a<e.length;++a)s.fillText(""+e[a],0,l),l+=1.5*d[t.level].size;else s.fillText(e,0,0);s.restore()}}),f[0].display){var D,L,O=0;if(k)D=a.left+(a.right-a.left)/2,L="bottom"===l[0].position?a.bottom-h.size/2:a.top+h.size/2;else{var M="left"===l[0].position;D=M?a.left+h.size/2:a.right-h.size/2,L=a.top+(a.bottom-a.top)/2,O=M?-.5*Math.PI:-.5*Math.PI}s.save(),s.translate(D,L),s.rotate(O),s.textAlign="center",s.textBaseline="middle",s.fillStyle=p,s.font=h.font,s.fillText(f[0].labelString,0,0),s.restore()}if(c[0].drawBorder){s.lineWidth=i.getValueAtIndexOrDefault(c[0].lineWidth,0),s.strokeStyle=i.getValueAtIndexOrDefault(c[0].color,0);var z=a.left,F=a.right,w=a.top,V=a.bottom,C=i.aliasPixel(s.lineWidth);k?(w=V="top"===l[0].position?a.bottom:a.top,w+=C,V+=C):(z=F="left"===l[0].position?a.right:a.left,z+=C,F+=C),s.beginPath(),s.moveTo(z,w),s.lineTo(F,V),s.stroke()}}},calculateTickRotation:function(){var t=this,e=t.ctx,a=[t.options.ticks,t.options.subScale.ticks,t.options.subScale.subScale.ticks],l=t.parseFontOptions(a[0]),o=t.labelRotation=a[0].minRotation||0;if(t.options.display){if(t.isHorizontal())for(var s,r,n=i.longestText(e,l.font,t.displayTicks,t.longestTextCache),c=n,f=t.displayTicks[0],d=t.displayTicks[1],u=t.displayTicks[t.displayTicks.length-2],g=t.displayTicks[t.displayTicks.length-1],p=t.getPixelForValue(d)-t.getPixelForValue(f)-6,h=t.getPixelForValue(g)-t.getPixelForValue(u)-6,k=Math.min(p,h);c>k&&o<a[0].maxRotation;){var m=i.toRadians(o);if(s=Math.cos(m),r=Math.sin(m),r*n>t.maxHeight){o--;break}o++,c=s*n}if(t.isHorizontal()){var x;m=i.toRadians(o),s=Math.cos(m),c=s*e.measureText(d).width,void 0!==a[0].min&&p<c&&(x=t.ticks.indexOf(d.toString(10)),t.isDisplayTicks[x]=!1),c=s*e.measureText(g).width,void 0!==a[0].max&&h<c&&(x=t.ticks.indexOf(u.toString(10)),t.isDisplayTicks[x]=!1)}else{var v,T;v=t.getPixelForValue(d)-t.getPixelForValue(f),T=Math.round(1.2*l.size),v<T&&(x=t.ticks.indexOf(d.toString(10)),t.isDisplayTicks[x]=!1),v=t.getPixelForValue(g)-t.getPixelForValue(u),T=Math.round(1.2*l.size),v<T&&(x=t.ticks.indexOf(u.toString(10)),t.isDisplayTicks[x]=!1)}}}});t.scaleService.registerScaleType("fineLinear",a,e)}},{}]},{},[1]);