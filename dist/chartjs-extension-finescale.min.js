/* !
 * chartjs-extension-finescale.js
 *
 * Version: 0.0.1
 *
 * chartjs-extension-finescale.js Copyright 2016 koyoSE
 * Released under the MIT license
 * https://github.com/KoyoSE/chartjs-extension-finescale.git
 *
 * Chart.js Copyright 2016 Nick Downie
 * Released under the MIT license
 * https://github.com/chartjs/Chart.js/blob/master/LICENSE.md
 */
!function i(t,e,a){function l(s,r){if(!e[s]){if(!t[s]){var n="function"==typeof require&&require;if(!r&&n)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=e[s]={exports:{}};t[s][0].call(d.exports,function(i){var e=t[s][1][i];return l(e?e:i)},d,d.exports,i,t,e,a)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)l(a[s]);return l}({1:[function(i,t,e){i(2)(Chart),i(3)(Chart),i(4)(Chart)},{2:2,3:3,4:4}],2:[function(i,t,e){"use strict";t.exports=function(i){var t=i.helpers;i.FineScale={niceNum:function(i,e){var a,l=Math.floor(t.log10(i)),o=i/Math.pow(10,l);return a=e?o<=1?5:o<=5?10:20:o<=1?1:o<=2?2:o<=5?5:10,a*Math.pow(10,l)},computeTextSize:function(i,e,a){return t.isArray(e)?t.longestText(i,a,e):i.measureText(e).width},parseFontOptions:function(e){var a=t.getValueOrDefault,l=i.defaults.global,o=a(e.fontSize,l.defaultFontSize),s=a(e.fontStyle,l.defaultFontStyle),r=a(e.fontFamily,l.defaultFontFamily);return{size:o,style:s,family:r,font:t.fontString(o,s,r)}},draw:function(e){var a=this,l=[a.options,a.options.subScale,a.options.subScale.subScale];if(l[0].display){var o,s=a.ctx,r=i.defaults.global,n=[l[0].ticks,l[1].ticks,l[2].ticks],c=[l[0].gridLines,l[1].gridLines,l[2].gridLines],d=[l[0].scaleLabel,l[1].scaleLabel,l[2].scaleLabel];n[0].maxTicksLimit&&(o=n[0].maxTicksLimit);var f=[a.parseFontOptions(n[0]),a.parseFontOptions(n[1]),a.parseFontOptions(n[2])],u=c[0].drawTicks?[c[0].tickMarkLength,c[1].drawTicks?c[1].tickMarkLength||.6*c[0].tickMarkLength:0,c[2].drawTicks?c[2].tickMarkLength||.4*c[0].tickMarkLength:0]:[0,0,0],p=[],g=t.getValueOrDefault(d[0].fontColor,r.defaultFontColor),h=a.parseFontOptions(d[0]),m=a.isHorizontal(),k=0!==a.labelRotation,x=t.toRadians(a.labelRotation);if(m){var v=!1;if(n[0].autoSkip){var T=Math.cos(x),y=k?a.longestLabelWidth*T/2:a.longestLabelWidth*T,S=(y+n[0].autoSkipPadding)*a.displayTicks.length,b=a.width-(a.paddingLeft+a.paddingRight);if(S>b&&(v=1+Math.floor(S/b)),o&&a.displayTicks.length>o)for(;!v||a.ticks.length/(v||1)>o;)v||(v=1),v+=1}}if(t.each(a.ticks,function(i,o){if(void 0!==i&&null!==i){var s=a.tickLevels[o];if(l[s].display){var d=a.displayTicks.length===o+1,f=v>1&&o%v>0||o%v===0&&o+v>=a.displayTicks.length;if(!f||d){var g,h,T=t.getValueOrDefault(c[s].borderDash,c[0].borderDash),y=t.getValueOrDefault(c[s].borderDashOffset,c[0].borderDashOffset),S=!!c[0].display&&t.getValueOrDefault(c[s].display,c[0].display),b=!!c[0].drawTicks&&t.getValueOrDefault(c[s].drawTicks,c[0].drawTicks),D=!!c[0].drawOnChartArea&&t.getValueOrDefault(c[s].drawOnChartArea,c[0].drawOnChartArea);if(o===("undefined"!=typeof a.zeroLineIndex?a.zeroLineIndex:0))g=c[0].zeroLineWidth,h=c[0].zeroLineColor;else{var L=t.getValueAtIndexOrDefault(c[0].lineWidth,o),M=t.getValueAtIndexOrDefault(c[s].lineWidth,o,c[0].lineWidth);g=t.isArray(c[0].lineWidth)?L:M;var O=t.getValueAtIndexOrDefault(c[0].color,o),F=t.getValueAtIndexOrDefault(c[s].color,o,c[0].color);h=t.isArray(c[0].color)?O:F}var w,z,V,C,Y,P,A,R,W,I,X=t.getValueOrDefault(n[s].fontColor,r.defaultFontColor),B="middle",N="middle";if(m){"bottom"===l[0].position?(N="top",B=k?"right":"center",I=k?a.top+u[0]:a.top+u[s]):(N="bottom",B=k?"left":"center",I=k?a.bottom-u[0]:a.bottom-u[s]),W=a.getPixelForTick(o,c[0].offsetGridLines)+n[0].labelOffset;var q=a.getPixelForTick(o)+t.aliasPixel(g),H="bottom"===l[0].position?a.top:a.bottom-u[s],U="bottom"===l[0].position?a.top+u[s]:a.bottom;w=V=Y=A=q,z=H,C=U,P=e.top,R=e.bottom}else{var E,G="left"===l[0].position,Q=n[0].padding;n[0].mirror?(B=G?"left":"right",E=Q):(B=G?"right":"left",E=u[s]+Q),W=G?a.right-E:a.left+E;var _=a.getPixelForTick(o)+t.aliasPixel(g);I=a.getPixelForTick(o,c[0].offsetGridLines);var j="right"===l[0].position?a.left:a.right-u[s],J="right"===l[0].position?a.left+u[s]:a.right;w=j,V=J,Y=e.left,A=e.right,z=C=P=R=_}p.push({display:S,level:s,tlDraw:b,tlX1:w,tlY1:z,tlX2:V,tlY2:C,tlColor:c[0].color,glDraw:D,glX1:Y,glY1:P,glX2:A,glY2:R,glWidth:g,glColor:h,glBorderDash:T,glBorderDashOffset:y,lDisplay:a.isDisplayTicks[o],lX:W,lY:I,label:i,lRotation:-1*x,lTextBaseline:N,lTextAlign:B,lFontColor:X})}}}}),t.each(p,function(i){if(i.display&&(s.save(),s.lineWidth=i.glWidth,s.strokeStyle=i.tlColor,s.beginPath(),i.tlDraw&&(s.moveTo(i.tlX1,i.tlY1),s.lineTo(i.tlX2,i.tlY2)),s.stroke(),s.strokeStyle=i.glColor,s.setLineDash&&(s.setLineDash(i.glBorderDash),s.lineDashOffset=i.glBorderDashOffset),i.glDraw&&(s.moveTo(i.glX1,i.glY1),s.lineTo(i.glX2,i.glY2)),s.stroke(),s.restore()),i.lDisplay){s.save(),s.translate(i.lX,i.lY),s.rotate(i.lRotation),s.font=f[i.level].font,s.fillStyle=i.lFontColor,s.textBaseline=i.lTextBaseline,s.textAlign=i.lTextAlign;var e=i.label;if(t.isArray(e))for(var a=0,l=0;a<e.length;++a)s.fillText(""+e[a],0,l),l+=1.5*f[i.level].size;else s.fillText(e,0,0);s.restore()}}),d[0].display){var D,L,M=0;if(m)D=a.left+(a.right-a.left)/2,L="bottom"===l[0].position?a.bottom-h.size/2:a.top+h.size/2;else{var O="left"===l[0].position;D=O?a.left+h.size/2:a.right-h.size/2,L=a.top+(a.bottom-a.top)/2,M=O?-.5*Math.PI:-.5*Math.PI}s.save(),s.translate(D,L),s.rotate(M),s.textAlign="center",s.textBaseline="middle",s.fillStyle=g,s.font=h.font,s.fillText(d[0].labelString,0,0),s.restore()}if(c[0].drawBorder){s.lineWidth=t.getValueAtIndexOrDefault(c[0].lineWidth,0),s.strokeStyle=t.getValueAtIndexOrDefault(c[0].color,0);var F=a.left,w=a.right,z=a.top,V=a.bottom,C=t.aliasPixel(s.lineWidth);m?(z=V="top"===l[0].position?a.bottom:a.top,z+=C,V+=C):(F=w="left"===l[0].position?a.right:a.left,F+=C,w+=C),s.beginPath(),s.moveTo(F,z),s.lineTo(w,V),s.stroke()}}},calculateTickRotation:function(){var i=this,e=i.ctx,a=[i.options.ticks,i.options.subScale.ticks,i.options.subScale.subScale.ticks],l=i.parseFontOptions(a[0]),o=i.labelRotation=a[0].minRotation||0;if(i.options.display){var s=i.displayTicks[0],r=i.displayTicks[1],n=i.displayTicks[i.displayTicks.length-2],c=i.displayTicks[i.displayTicks.length-1];if(i.isHorizontal()){for(var d,f,u=t.longestText(e,l.font,i.displayTicks,i.longestTextCache),p=u,g=i.getPixelForValue(r)-i.getPixelForValue(s)-6,h=i.getPixelForValue(c)-i.getPixelForValue(n)-6,m=Math.min(g,h);p>m&&o<a[0].maxRotation;){var k=t.toRadians(o);if(d=Math.cos(k),f=Math.sin(k),f*u>i.maxHeight){o--;break}o++,p=d*u}var x;k=t.toRadians(o),d=Math.cos(k),p=d*e.measureText(r).width,void 0!==a[0].min&&g<p&&(x=i.ticks.indexOf(r.toString(10)),i.isDisplayTicks[x]=!1),p=d*e.measureText(c).width,void 0!==a[0].max&&h<p&&(x=i.ticks.indexOf(n.toString(10)),i.isDisplayTicks[x]=!1)}else{var v,T;T=Math.round(1.2*l.size),v=i.getPixelForValue(r)-i.getPixelForValue(s),void 0!==a[0].min&&v<T&&(x=i.ticks.indexOf(r.toString(10)),i.isDisplayTicks[x]=!1),v=i.getPixelForValue(c)-i.getPixelForValue(n),void 0!==a[0].max&&v<T&&(x=i.ticks.indexOf(n.toString(10)),i.isDisplayTicks[x]=!1)}}}}}},{}],3:[function(i,t,e){"use strict";t.exports=function(i){var t=i.helpers,e={position:"left",subScale:{display:!0,ticks:{display:!0,fontSize:11},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.07)"},subScale:{display:!0,ticks:{display:!1,fontSize:10},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.03)"}}}},a=i.scaleService.getScaleConstructor("linear").extend(i.FineScale),l=a.extend({fineLinear:function(i,e){var a=this,l=[],o=[],s=[],r=[],n=i.optsTick,c=a.niceNum(e.max-e.min,!1),d=[];d[0]=a.niceNum(c/(i.maxTicks-1),!0),d[1]=a.niceNum(d[0]/10,!0),d[2]=a.niceNum(d[1]/10,!0);var f=2;if(i.stepSize&&i.stepSize>0){for(var u=i.stepSize;(e.max-e.min)/u>1e3;)u*=10;for(var p=u,g=0;g<i.levelMax;g++)d[g]<=u&&(d[g]=p,f=0!==p?g:f,p=0);d[f]=d[f]>u?u:d[f]}var h,m,k=Math.floor(e.min/d[0])*d[0],x=Math.ceil(e.max/d[0])*d[0],v=void 0!==i.min?i.min:k,T=void 0!==i.max?i.max:x,y=function(i){i=0===i?1:i;var e=Math.floor(t.log10(i));return{digits:e>0?0:Math.abs(e),magnification:Math.pow(10,e)}},S=[y(d[0]),y(d[1]),y(d[2])],b=function(i,t,e){var a=i/e%(t[0]/e),l=i/e%(t[1]/e);return 0===a?0:0===l?1:2},D=+((x-k)/d[f]).toFixed(S[f].digits);l.push(v),o.push(b(v,d,S[f].magnification));for(var L=1;L<D;L++)m=k+ +(L*d[f]).toFixed(S[f].digits),m<=v||T<=m||(h=b(m,d,S[f].magnification),l.push(+m.toFixed(S[h].digits)),o.push(h));l.push(T),o.push(b(T,d,S[f].magnification));var M;for(L=0;L<l.length;L++)M=0===L||(L===l.length-1||!!n[o[L]].display),s.push(M),M&&r.push(l[L]);return{ticks:l,levels:o,min:v,max:T,isDisplayTicks:s,displayTicks:r}},ticksReverse:function(){var i=this;i.ticks.reverse(),i.tickLevels.reverse(),i.isDisplayTicks.reverse(),i.displayTicks.reverse()},handleDirectionalChanges:function(){var i=this;i.isHorizontal()||i.ticksReverse()},getTickLimit:function(){var e,a=this,l=a.options.ticks;if(a.isHorizontal())e=Math.min(l.maxTicksLimit?l.maxTicksLimit:11,Math.ceil(a.width/50));else{var o=t.getValueOrDefault(l.fontSize,i.defaults.global.defaultFontSize);e=Math.min(l.maxTicksLimit?l.maxTicksLimit:11,Math.ceil(a.height/(1.5*o)))}return Math.max(2,e)},buildTicks:function(){var i=this;i.levelMax=3;var e=i.options,a=[e.ticks,e.subScale.ticks,e.subScale.subScale.ticks],l=i.getTickLimit(),o={maxTicks:l,min:a[0].min,max:a[0].max,stepSize:t.getValueOrDefault(a[0].fixedStepSize,a[0].stepSize),optsTick:a,levelMax:i.levelMax},s=i.fineLinear(o,i);i.ticks=s.ticks,i.tickLevels=s.levels,i.isDisplayTicks=s.isDisplayTicks,i.displayTicks=s.displayTicks,i.handleDirectionalChanges(),i.max=s.max,i.min=s.min,a[0].reverse?(i.ticksReverse(),i.start=i.max,i.end=i.min):(i.start=i.min,i.end=i.max)}});i.scaleService.registerScaleType("fineLinear",l,e)}},{}],4:[function(i,t,e){"use strict";t.exports=function(i){var t={position:"bottom",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm:ss a",hour:"MMM D, hA",day:"ll",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1},subScale:{display:!0,ticks:{display:!0,fontSize:11},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.07)"},subScale:{display:!0,ticks:{display:!1,fontSize:10},gridLines:{display:!0,drawTicks:!0,color:"rgba(0, 0, 0, 0.03)"}}}},e=i.scaleService.getScaleConstructor("time").extend({});i.scaleService.registerScaleType("fineTime",e,t)}},{}]},{},[1]);